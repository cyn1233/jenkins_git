#新生成的镜像是基于nginx+tomcat+java:dockerfile镜像
FROM centos
MAINTAINER by cmzsteven
WORKDIR /opt/src
ENV LANG C.UTF-8
#安装wget
RUN yum install -y  wget
#Copy jdk and tomcat into image
ADD ./apache-tomcat-7.0.82.tar.gz /opt/
ADD ./jdk-7u80-linux-x64.tar.gz /opt/
RUN cd /opt/ tar -xvf apache-tomcat-7.0.82.tar.gz && rm -rf  apache-tomcat-7.0.82.tar.gz
RUN cd /opt/ tar -xvf jdk-7u80-linux-x64.tar.gz   && rm -rf  jdk-7u80-linux-x64.tar.gz
#Set JAVA env variable
ENV JAVA_HOME /opt/jdk1.7.0_80
ENV CATALINA_HOME /opt/apache-tomcat-7.0.82
ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/bin
#复制服务启动脚本并设置权限
RUN mkdir -p /opt/sbin
ADD ./run.sh /opt/sbin/
RUN chmod 755 /opt/sbin/run.sh
#设置生成容器时需要执行的脚本
CMD ["/opt/sbin/run.sh"]
#开放22、80、443端口
EXPOSE 8080
